!function(s,o){function e(e){var t=this;t.$form=e,t.params=wc_gzd_single_product_params,t.$wrapper=e.closest(wc_gzd_single_product_params.wrapper),t.$product=e.closest(".product"),t.requests=[],t.observer={},t.timeout=!1,t.$wrapper.length<=0&&(t.$wrapper=t.$product),("MutationObserver"in o||"WebKitMutationObserver"in o||"MozMutationObserver"in o)&&(t.initObserver(t),e.hasClass("variations_form")?(t.productId=0<e.find("input[name=product_id]").length?e.find("input[name=product_id]").val():t.params.product_id,t.variatonId=0<e.find("input[name=variation_id]").length?e.find("input[name=variation_id]").val():0,e.on("reset_data",{GermanizedSingleProductWatcher:t},t.onResetVariation),e.on("found_variation.wc-variation-form",{GermanizedSingleProductWatcher:t},t.onFoundVariation)):t.productId=0<e.find("*[name=add-to-cart][type=submit]").length?e.find("*[name=add-to-cart][type=submit]").val():t.params.product_id)}e.prototype.initObserver=function(a){0===Object.keys(a.observer).length&&s.each(a.params.price_selector,function(r,i){var e,t=a.$wrapper.find(r+":not(.price-unit):visible"),n=!1;0<t.length&&(e=function(e,t){a.timeout&&(clearTimeout(a.timeout),a.abortAjaxRequests(a)),a.timeout=setTimeout(function(){var e=a.getCurrentPriceData(a,r,i.is_total_price);e&&s.active<=0&&a.refreshUnitPrice(a,e.price,e.unit_price,e.sale_price,e.quantity)},500)},"MutationObserver"in o?n=new o.MutationObserver(e):"WebKitMutationObserver"in o?n=new o.WebKitMutationObserver(e):"MozMutationObserver"in o&&(n=new o.MozMutationObserver(e)),n&&(a.observer[r]=n,a.observer[r].observe(t[0],{childList:!0,subtree:!0,characterData:!0})))})},e.prototype.cancelObserver=function(e){if(0<e.observer.length)for(var t in e.observer)e.observer.hasOwnProperty(t)&&(e.observer[t].disconnect(),delete e.observer[t])},e.prototype.abortAjaxRequests=function(e){if(0<e.requests.length)for(var t=0;t<e.requests.length;t++)e.requests[t].abort()},e.prototype.onResetVariation=function(e){e.data.GermanizedSingleProductWatcher.variationId=0},e.prototype.onFoundVariation=function(e,t){e=e.data.GermanizedSingleProductWatcher;t.hasOwnProperty("variation_id")&&(e.variationId=t.variation_id)},e.prototype.getCurrentPriceData=function(e,t,r){var i=s(e.params.wrapper+" "+t+":not(.price-unit):visible");if(0<i.length){var n=i.parents(e.params.wrapper).find(".price-unit:first"),a="",o=i.find(".amount:first"),c=s(e.params.wrapper+" "+e.params.qty_selector+":first"),t=1;0<c.length&&(t=parseFloat(c.val())),o.length<=0&&(o=0<i.find(".price").length?i.find(".price"):i);o=e.getRawPrice(o,e.params.price_decimal_sep);if(1<i.find(".amount").length&&(a=e.getRawPrice(i.find(".amount:last"),e.params.price_decimal_sep)),0<n.length&&o)return r&&(o=parseFloat(o)/t,0<a.length&&(a=parseFloat(a)/t)),{price:o,unit_price:n,sale_price:a,quantity:t}}return!1},e.prototype.getCurrentProductId=function(e){var t=e.productId;return 0<e.variationId&&(t=e.variationId),parseInt(t)},e.prototype.getRawPrice=function(t,e){var r=0<t.length?t.text():"",t=!1;try{t=accounting.unformat(r,e)}catch(e){t=!1}return t},e.prototype.refreshUnitPrice=function(t,e,r,i,n){t.abortAjaxRequests(t),t.requests.push(s.ajax({type:"POST",url:t.params.wc_ajax_url.toString().replace("%%endpoint%%","gzd_refresh_unit_price"),data:{security:t.params.refresh_unit_price_nonce,product_id:t.getCurrentProductId(t),price:e,price_sale:i,quantity:n},success:function(e){parseInt(e.product_id)===t.getCurrentProductId(t)&&e.hasOwnProperty("unit_price_html")&&r.html(e.unit_price_html)},error:function(e){},dataType:"json"}))},s.fn.wc_germanized_single_product_watch=function(){return new e(this),this},s(function(){"undefined"!=typeof wc_gzd_single_product_params&&s("form.variations_form, "+wc_gzd_single_product_params.wrapper+" form.cart").each(function(){s(this).wc_germanized_single_product_watch()})})}(jQuery,window,document),window.germanized=window.germanized||{};