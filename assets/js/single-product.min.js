window.germanized=window.germanized||{},function(o,c){c.single_product={params:{},requests:[],productId:0,variationId:0,init:function(){var e=c.single_product;e.params=wc_gzd_single_product_params,e.productId=e.params.product_id,accounting.settings={currency:{decimal:e.params.price_decimal_sep,thousand:e.params.price_thousand_sep},number:{decimal:e.params.price_decimal_sep,thousand:e.params.price_thousand_sep}},o(e.params.wrapper+" "+e.params.price_selector+":not(.price-unit):visible").on("DOMSubtreeModified",e.onChangePrice),0<o(".variations_form").length&&o(".variations_form").each(function(){var r=o(this);r.on("reset_data",e.onResetVariation),r.on("found_variation.wc-variation-form",e.onFoundVariation)})},onFoundVariation:function(r,e){var i=c.single_product;e.hasOwnProperty("variation_id")&&(i.variationId=e.variation_id)},onResetVariation:function(){c.single_product.variationId=0},onChangePrice:function(t){setTimeout(function(){var r,e,i,n=c.single_product,a=o(n.params.wrapper+" "+n.params.price_selector+":not(.price-unit):visible");t.preventDefault(),0<a.length&&(o(n.params.wrapper+" "+n.params.price_selector+":not(.price-unit):visible").off("DOMSubtreeModified",n.onChangePrice),r=a.parents(n.params.wrapper).find(".price-unit:first"),e=n.getRawPrice(a.find(".amount:first")),i="",1<a.find(".amount").length&&(i=n.getRawPrice(a.find(".amount:last"))),0<r.length&&e&&n.refreshUnitPrice(e,r,i),o(n.params.wrapper+" "+n.params.price_selector+":not(.price-unit):visible").on("DOMSubtreeModified",n.onChangePrice))},500)},getRawPrice:function(r){var e=0<r.length?r.text():"",i=!1;try{i=accounting.unformat(e)}catch(r){i=!1}return i},refreshUnitPrice:function(r,e,i){var n=c.single_product;if(0<n.requests.length)for(var a=0;a<n.requests.length;a++)n.requests[a].abort();n.requests.push(o.ajax({type:"POST",url:n.params.wc_ajax_url.toString().replace("%%endpoint%%","gzd_refresh_unit_price"),data:{security:n.params.refresh_unit_price_nonce,product_id:0<n.variationId?n.variationId:n.productId,price:r,price_sale:i},success:function(r){r.hasOwnProperty("unit_price_html")&&e.html(r.unit_price_html)},error:function(r){},dataType:"json"}))}},o(document).ready(function(){c.single_product.init()})}(jQuery,window.germanized);