window.germanized=window.germanized||{},function(a,n){n.cart_voucher={params:{},vouchers:{},init:function(){this.params=wc_gzd_cart_voucher_params,this.vouchers=wc_gzd_cart_voucher_params.vouchers,a(".woocommerce-checkout").length&&this.manipulate_checkout_totals(),a(".woocommerce-cart-form").length&&this.manipulate_cart_totals(),a(document.body).on("updated_cart_totals",this.manipulate_cart_totals),a(document.body).on("updated_checkout",this.manipulate_checkout_totals),a(document.body).on("applied_coupon",this.refresh_cart_vouchers),a(document.body).on("removed_coupon",this.refresh_cart_vouchers)},refresh_cart_vouchers:function(){var o=n.cart_voucher;setTimeout(function(){a.ajax({type:"POST",url:o.params.wc_ajax_url.toString().replace("%%endpoint%%","gzd_refresh_cart_vouchers"),data:{security:o.params.refresh_cart_vouchers_nonce},success:function(e){o.vouchers=e.vouchers,o.manipulate_cart_totals()},dataType:"json"})},75)},manipulate_checkout_totals:function(e,o){var t=n.cart_voucher,r=a(".woocommerce-checkout #order_review table");(o=void 0===o?{}:o).hasOwnProperty("fragments")&&o.fragments.hasOwnProperty(".gzd-vouchers")&&(t.vouchers=o.fragments[".gzd-vouchers"]),t.params.display_prices_including_tax||t.move_vouchers_before_total_checkout(),t.manipulate_coupons(r)},manipulate_cart_totals:function(){var e=a(".cart_totals table"),o=e.find("tr.order-total"),t=n.cart_voucher;t.params.display_prices_including_tax||(t.move_vouchers_before_total(e,o),a(".woocommerce-checkout").length&&t.move_vouchers_before_total_checkout()),t.manipulate_coupons(e)},manipulate_coupons:function(r){var c=n.cart_voucher;a.each(c.vouchers,function(e,o){var t=c.get_voucher_coupon(o,r),o=c.get_voucher_fee(o,r);t.hide(),0<o.length&&0<t.length&&(0<(t=t.find("a.woocommerce-remove-coupon")).length&&(o.find("td:last").append(" "),o.find("td:last").append(t)))})},move_vouchers_before_total_checkout:function(){var e=a(".woocommerce-checkout #order_review table"),o=e.find("tr.order-total");n.cart_voucher.move_vouchers_before_total(e,o)},get_voucher_fee:function(e,o){return o.find('tr.fee th:contains("'+e.name+'")').parents("tr")},get_voucher_coupon:function(e,o){return o.find("tr."+e.coupon_class)},move_vouchers_before_total:function(t,r){var c=n.cart_voucher;a.each(c.vouchers,function(e,o){o=c.get_voucher_fee(o,t);0<o.length&&o.insertBefore(r)})}},a(document).ready(function(){n.cart_voucher.init()})}(jQuery,window.germanized);