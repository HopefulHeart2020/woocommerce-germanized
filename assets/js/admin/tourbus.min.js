!function o(n,r,h){function l(s,t){if(!r[s]){if(!n[s]){var i="function"==typeof require&&require;if(!t&&i)return i(s,!0);if(u)return u(s,!0);throw new Error("Cannot find module '"+s+"'")}var e=r[s]={exports:{}};n[s][0].call(e.exports,function(t){var i=n[s][1][t];return l(i||t)},e,e.exports,o,n,r,h)}return r[s].exports}for(var u="function"==typeof require&&require,t=0;t<h.length;t++)l(h[t]);return l}({1:[function(t,i,s){(function(){var e,o,i,s,n,r=[].slice;e=jQuery,o=t("./modules/bus"),i=t("./modules/leg"),n=e.tourbus=function(){var t,i;return i=(t=1<=arguments.length?r.call(arguments,0):[])[0],s.hasOwnProperty(i)?t=t.slice(1):i instanceof e?i="build":"string"==typeof i?(i="build",t[0]=e(t[0])):e.error("Unknown method of $.tourbus --",t),s[i].apply(this,t)},e.fn.tourbus=function(){var t;return t=1<=arguments.length?r.call(arguments,0):[],this.each(function(){return t.unshift(e(this)),n.apply(null,["build"].concat(r.call(t))),this})},s={build:function(t,i){var s;return null==i&&(i={}),i=e.extend(!0,{},n.defaults,i),s=[],t instanceof e||(t=e(t)),t.each(function(){return s.push(new o(this,i))}),0===s.length&&e.error(t.selector+" was not found!"),1===s.length?s[0]:s},destroyAll:function(){var t,i,s,e;for(i in e=[],s=o._busses)t=s[i],e.push(t.destroy());return e},expose:function(t){return t.tourbus={Bus:o,Leg:i}}},n.defaults={debug:!1,autoDepart:!1,container:"body",class:null,startAt:0,onDepart:function(){return null},onStop:function(){return null},onLegStart:function(){return null},onLegEnd:function(){return null},leg:{class:null,scrollTo:null,scrollSpeed:150,scrollContext:100,orientation:"bottom",align:"left",width:"auto",margin:10,top:null,left:null,zindex:9999,arrow:"50%"}}}).call(this)},{"./modules/bus":2,"./modules/leg":3}],2:[function(e,r,t){(function(){var o,n,s,t=[].slice;function i(t,i){this.options=i,this.id=this.constructor.uniqueId(),this.elId="tourbus-"+this.id,(this.constructor._busses[this.id]=this).$original=o(t),this.rawData=this.$original.data(),this.$container=o(s.dataProp(this.rawData.container,this.options.container)),this.$original.data({tourbus:this}),this.currentLegIndex=null,this.legs=[],this.legEls=this.$original.children("li"),this.totalLegs=this.legEls.length,this._configureElement(),this._setupEvents(),s.dataProp(this.rawData.autoDepart,this.options.autoDepart)&&this.$original.trigger("depart.tourbus"),this._log("built tourbus with el",t.toString(),"and options",this.options)}o=jQuery,n=e("./leg"),s=e("./utils"),r.exports=(i._busses={},i._tours=0,i.uniqueId=function(){return this._tours++},i.prototype.depart=function(){return this.running=!0,this.options.onDepart(this),this._log("departing",this),this.currentLegIndex=s.dataProp(this.rawData.startAt,this.options.startAt),this.showLeg()},i.prototype.stop=function(){if(this.running)return o.each(this.legs,o.proxy(this.hideLeg,this)),this.currentLegIndex=null,this.options.onStop(this),this.running=!1},i.prototype.on=function(t,i,s){return this.$container.on(t,i,s)},i.prototype.currentLeg=function(){return null===this.currentLegIndex?null:this.legs[this.currentLegIndex]},i.prototype.buildLeg=function(t){var i,s,e;return s=(i=o(this.legEls[t])).data(),this.legs[t]=e=new n({bus:this,original:i,target:s.el||"body",index:t,rawData:s}),e.render(),this.$el.append(e.$el),e._position(),e.hide(),e},i.prototype.showLeg=function(t){var i;if(null==t&&(t=this.currentLegIndex),i=this.legs[t]||this.buildLeg(t),this._log("showLeg:",i),!1!==this.options.onLegStart(i,this)&&i.show(),++t<this.totalLegs&&!this.legs[t])return this.buildLeg(t)},i.prototype.hideLeg=function(t){var i;if(null==t&&(t=this.currentLegIndex),(i=this.legs[t])&&i.visible&&(this._log("hideLeg:",i),!1!==this.options.onLegEnd(i,this)&&i.hide()),0<--t&&!this.legs[t])return this.buildLeg(t)},i.prototype.repositionLegs=function(){return o.each(this.legs,function(){return this.reposition()})},i.prototype.next=function(){return this.hideLeg(),this.currentLegIndex++,this.currentLegIndex>this.totalLegs-1?this.$original.trigger("stop.tourbus"):this.showLeg()},i.prototype.prev=function(t){return this.hideLeg(),this.currentLegIndex--,this.currentLegIndex<0?this.$original.trigger("stop.tourbus"):this.showLeg()},i.prototype.destroy=function(){return o.each(this.legs,function(){return this.destroy()}),this.legs=[],delete this.constructor._busses[this.id],this._teardownEvents(),this.$original.removeData("tourbus"),this.$el.remove()},i.prototype._configureElement=function(){return this.$el=o("<div class='tourbus-container'></div>"),this.el=this.$el[0],this.$el.attr({id:this.elId}),this.$el.addClass(s.dataProp(this.rawData.class,this.options.class)),this.$container.append(this.$el)},i.prototype._log=function(){if(s.dataProp(this.rawData.debug,this.options.debug))return console.log.apply(console,["TOURBUS "+this.id+":"].concat(t.call(arguments)))},i.prototype._setupEvents=function(){return this.$original.on("depart.tourbus",o.proxy(this.depart,this)),this.$original.on("stop.tourbus",o.proxy(this.stop,this)),this.$original.on("next.tourbus",o.proxy(this.next,this)),this.$original.on("prev.tourbus",o.proxy(this.prev,this))},i.prototype._teardownEvents=function(){return this.$original.off(".tourbus")},i)}).call(this)},{"./leg":3,"./utils":4}],3:[function(s,e,t){(function(){var l,u,o,t,n;function i(t){if(this.options=t,this.$original=this.options.original,this.bus=this.options.bus,this.rawData=this.options.rawData,this.index=this.options.index,this.$target=l(this.options.target),this.id=this.bus.id+"-"+this.options.index,this.elId="tourbus-leg-"+this.id,this.visible=!1,0===this.$target.length)throw this.$target.selector+" is not an element!";this.content=this.$original.html(),this._setupOptions(),this._configureElement(),this._configureTarget(),this._configureScroll(),this._setupEvents(),this.bus._log("leg "+this.index+" made with options",this.options)}l=jQuery,u=s("./utils"),e.exports=(i.prototype.render=function(){var t,i;return t="centered"===this.options.orientation?"":"tourbus-arrow",this.$el.addClass(" "+t+" tourbus-arrow-"+this.options.orientation+" "),i="<div class='tourbus-leg-inner'>\n  "+this.content+"\n</div>",this.$el.css({width:this.options.width,zIndex:this.options.zindex}).html(i),this},i.prototype.destroy=function(){return this.$el.remove(),this._teardownEvents()},i.prototype.reposition=function(){return this._configureTarget(),this._position()},i.prototype._position=function(){var t,i,s,e;return"centered"!==this.options.orientation&&(s={},i={top:"left",bottom:"left",left:"top",right:"top"},"number"==typeof this.options.arrow&&(this.options.arrow+="px"),s[i[this.options.orientation]]=this.options.arrow,e="#"+this.elId+".tourbus-arrow",this.bus._log("adding rule for "+this.elId,s),o(e+":before, "+e+":after",s)),t=this._offsets(),this.bus._log("setting offsets on leg",t),this.$el.css(t)},i.prototype.show=function(){return this.visible=!0,this.$el.css({visibility:"visible",opacity:1,zIndex:this.options.zindex}),this.scrollIntoView()},i.prototype.hide=function(){return this.visible=!1,this.bus.options.debug?this.$el.css({visibility:"visible",opacity:.4,zIndex:0}):this.$el.css({visibility:"hidden"})},i.prototype.scrollIntoView=function(){var t;if(this.willScroll)return t=u.dataProp(this.options.scrollTo,this.$el),this.bus._log("scrolling to",t,this.scrollSettings),l.scrollTo(t,this.scrollSettings)},i.prototype._setupOptions=function(){var t,i,s,e,o,n;for(i=this.bus.options.leg,n=[],e=0,o=(t=["class","top","left","scrollTo","scrollSpeed","scrollContext","margin","arrow","align","width","zindex","orientation"]).length;e<o;e++)s=t[e],n.push(this.options[s]=u.dataProp(this.rawData[s],i[s]));return n},i.prototype._configureElement=function(){return this.$el=l("<div class='tourbus-leg'></div>"),this.el=this.$el[0],this.$el.attr({id:this.elId}),this.$el.addClass(this.options.class),this.$el.css({zIndex:this.options.zindex})},i.prototype._setupEvents=function(){return this.$el.on("click",".tourbus-next",l.proxy(this.bus.next,this.bus)),this.$el.on("click",".tourbus-prev",l.proxy(this.bus.prev,this.bus)),this.$el.on("click",".tourbus-stop",l.proxy(this.bus.stop,this.bus))},i.prototype._teardownEvents=function(){return this.$el.off("click")},i.prototype._configureTarget=function(){return this.targetOffset=this.$target.offset(),u.dataProp(this.options.top,!1)&&(this.targetOffset.top=this.options.top),u.dataProp(this.options.left,!1)&&(this.targetOffset.left=this.options.left),this.targetWidth=this.$target.outerWidth(),this.targetHeight=this.$target.outerHeight()},i.prototype._configureScroll=function(){return this.willScroll=l.fn.scrollTo&&!1!==this.options.scrollTo,this.scrollSettings={offset:-this.options.scrollContext,easing:"linear",axis:"y",duration:this.options.scrollSpeed}},i.prototype._offsets=function(){var t,i,s,e,o,n,r,h;switch(s=this.$el.height(),e=this.$el.width(),o={},this.options.orientation){case"centered":r=l(window).height(),o.top=this.options.top,u.dataProp(o.top,!1)||(o.top=r/2-s/2),o.left=this.targetWidth/2-e/2;break;case"left":o.top=this.targetOffset.top,o.left=this.targetOffset.left-e-this.options.margin;break;case"right":o.top=this.targetOffset.top,o.left=this.targetOffset.left+this.targetWidth+this.options.margin;break;case"top":o.top=this.targetOffset.top-s-this.options.margin,o.left=this.targetOffset.left;break;case"bottom":o.top=this.targetOffset.top+this.targetHeight+this.options.margin,o.left=this.targetOffset.left}if(h={top:["left","right"],bottom:["left","right"],left:["top","bottom"],right:["top","bottom"]},u.include(this.options.orientation,h[this.options.align]))switch(this.options.align){case"right":o.left+=this.targetWidth-e;break;case"bottom":o.top+=this.targetHeight-s}else"center"===this.options.align&&(t=u.include(this.options.orientation,h.left)?(n=this.targetWidth/2,i=e/2,"left"):(n=this.targetHeight/2,i=s/2,"top"),i<n?o[t]+=n-i:o[t]-=i-n);return o},i),(t=document.createElement("style")).type="text/css",document.getElementsByTagName("head")[0].appendChild(t),n=document.styleSheets[document.styleSheets.length-1],o=function(t,i){var s,e;e=l.map(function(){var t;for(s in t=[],i)t.push(s);return t}(),function(t){return t+":"+i[t]}).join(";");try{n.insertRule?n.insertRule(t+" { "+e+" }",(n.cssRules||n.rules).length):n.addRule(t,e)}catch(t){}}}).call(this)},{"./utils":4}],4:[function(t,i,s){(function(){i.exports={dataProp:function(t,i){return null==t?i:t},include:function(t,i){return-1!==jQuery.inArray(t,i||[])}}}).call(this)},{}]},{},[1,2,3,4]);