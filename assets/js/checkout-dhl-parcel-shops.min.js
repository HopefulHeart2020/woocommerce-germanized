jQuery(function(a){var n={$parcelFinderButtonWrapper:a(wc_gzd_dhl_parcel_shops_params.button_wrapper),$parcelFinderWrapper:a(wc_gzd_dhl_parcel_shops_params.iframe_wrapper),$parcelCheckboxField:a("#shipping_parcelshop_field"),params:wc_gzd_dhl_parcel_shops_params,defaultAddressFieldLabel:"",defaultAddressFieldPlaceholder:"",supportedCountries:[],init:function(){n.params.enable_finder&&this.initParcelFinder(),this.initDefaultData(),this.$parcelCheckboxField.on("change","#shipping_parcelshop",this.parcelCheckboxChanged),a(document).on("change","#shipping_country",this.shippingCountryChanged),this.parcelCheckboxChanged(!0)},initDefaultData:function(){this.supportedCountries=this.params.supported_countries,this.defaultAddressFieldLabel=a("#shipping_address_1_field").find("label").contents().filter(function(){return 3==this.nodeType}).text(),this.defaultAddressFieldPlaceholder=a("#shipping_address_1").attr("placeholder")},shippingCountryChanged:function(){var e=a("#shipping_country").val();-1!==a.inArray(e,n.params.supported_countries)?n.$parcelCheckboxField.show():(a("#shipping_parcelshop").prop("checked",!1),n.$parcelCheckboxField.hide()),n.parcelCheckboxChanged(!1)},parcelCheckboxChanged:function(e){void 0!==e&&"boolean"===a.type(e)||(e=!1);var r=a("#shipping_address_1_field").find("label");a("#shipping_parcelshop").is(":checked")?(n.showFinderButton(),!e&&n.$parcelCheckboxField.hasClass("first-check")?(a("#shipping_address_1").val(""),n.$parcelCheckboxField.removeClass("first-check")):e&&n.$parcelCheckboxField.removeClass("first-check"),a("#shipping_parcelshop_post_number_field").show(),r.contents().filter(function(){return 3==this.nodeType}).first().replaceWith(n.params.address_field_title+" "),a("#shipping_address_1").attr("placeholder",n.params.address_field_placeholder),"DE"===a("#shipping_country").val()?(a("#shipping_address_2").val(""),a("#shipping_address_2").addClass("gzd-hidden").hide()):a("#shipping_address_2").show()):(n.hideFinderButton(),r.contents().filter(function(){return 3==this.nodeType}).first().replaceWith(n.defaultAddressFieldLabel),a("#shipping_address_2").hasClass("gzd-hidden")&&(a("#shipping_address_2").show(),a("#shipping_address_2").removeClass("gzd-hidden")),a("#shipping_address_1").attr("placeholder",n.defaultAddressFieldPlaceholder),a("#shipping_parcelshop_post_number_field").hide())},initParcelFinder:function(){this.$parcelFinderButtonWrapper.hide(),this.$parcelFinderWrapper.find("#wc-gzd-parcel-finder-background-overlay").hide(),this.$parcelFinderWrapper.on("click","#wc-gzd-parcel-finder-background-overlay",this.closeParcelFinder),this.$parcelFinderWrapper.on("click","#wc-gzd-parcel-finder-close-btn",this.closeParcelFinder),this.$parcelFinderButtonWrapper.on("click",".wc-gzd-parcel-finder-open-button",this.openParcelFinder),a(window).on("message",this.saveParcelFinder)},showFinderButton:function(){n.params.enable_finder&&n.$parcelFinderButtonWrapper.show()},hideFinderButton:function(){n.params.enable_finder&&n.$parcelFinderButtonWrapper.hide()},isValidJSON:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},saveParcelFinder:function(e){if("undefined"!==e.originalEvent.data&&n.isValidJSON(e.originalEvent.data)){var r=JSON.parse(e.originalEvent.data);if("object"==typeof r&&r.countryCode){var i=r.countryCode.toUpperCase();a(".wc-gzd-parcel-finder-shipping-country-error").remove(),-1!==a.inArray(i,n.supportedCountries)?(a("#shipping_country").val(r.countryCode.toUpperCase()).trigger("change"),a("#shipping_address_1").val(r.keyWord+" "+r.primaryKeyZipRegion),a("#shipping_address_2").val(r.street+" "+r.houseNo),a("#shipping_city").val(r.city),a("#shipping_postcode").val(r.zipCode)):(0<a(".woocommerce-error").length?a(".woocommerce-error").append('<li class="wc-gzd-parcel-finder-shipping-country-error">'+n.params.shipping_country_error+"</li>"):a("form.woocommerce-checkout").prepend('<ul class="woocommerce-error wc-gzd-parcel-finder-shipping-country-error"><li>'+n.params.shipping_country_error+"</li></ul>"),a("html, body").animate({scrollTop:a("form.checkout").offset().top-100},1e3)),"de"===r.countryCode&&a("#shipping_address_2").val(""),n.closeParcelFinder()}}},openParcelFinder:function(){return n.$parcelFinderWrapper.find("iframe").attr("src",n.params.iframe_src),n.$parcelFinderWrapper.find("#wc-gzd-parcel-finder-background-overlay").show(),!1},closeParcelFinder:function(){n.$parcelFinderWrapper.find("#wc-gzd-parcel-finder-background-overlay").hide()}};n.init()});