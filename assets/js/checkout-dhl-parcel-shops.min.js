jQuery(function(a){var b={$parcelFinderButtonWrapper:a(wc_gzd_dhl_parcel_shops_params.button_wrapper),$parcelFinderWrapper:a(wc_gzd_dhl_parcel_shops_params.iframe_wrapper),$parcelCheckboxField:a("#shipping_parcelshop_field"),params:wc_gzd_dhl_parcel_shops_params,defaultAddressFieldLabel:"",defaultAddressFieldPlaceholder:"",supportedCountries:[],init:function(){b.params.enable_finder&&this.initParcelFinder(),this.initDefaultData(),this.$parcelCheckboxField.on("change","#shipping_parcelshop",this.parcelCheckboxChanged),a(document).on("change","#shipping_country",this.shippingCountryChanged),this.parcelCheckboxChanged(!0)},initDefaultData:function(){this.supportedCountries=this.params.supported_countries,this.defaultAddressFieldLabel=a("#shipping_address_1_field").find("label").contents().filter(function(){return 3==this.nodeType}).text(),this.defaultAddressFieldPlaceholder=a("#shipping_address_1").attr("placeholder")},shippingCountryChanged:function(){var c=a("#shipping_country").val();-1!==a.inArray(c,b.params.supported_countries)?b.$parcelCheckboxField.show():(a("#shipping_parcelshop").prop("checked",!1),b.$parcelCheckboxField.hide()),b.parcelCheckboxChanged(!1)},parcelCheckboxChanged:function(c){("undefined"==typeof c||"boolean"!==a.type(c))&&(c=!1);var d=a("#shipping_address_1_field").find("label");a("#shipping_parcelshop").is(":checked")?(b.showFinderButton(),!c&&b.$parcelCheckboxField.hasClass("first-check")?(a("#shipping_address_1").val(""),b.$parcelCheckboxField.removeClass("first-check")):c&&b.$parcelCheckboxField.removeClass("first-check"),a("#shipping_parcelshop_post_number_field").show(),d.contents().filter(function(){return 3==this.nodeType}).first().replaceWith(b.params.address_field_title+" "),a("#shipping_address_1").attr("placeholder",b.params.address_field_placeholder),"DE"===a("#shipping_country").val()?(a("#shipping_address_2").val(""),a("#shipping_address_2").addClass("gzd-hidden").hide()):a("#shipping_address_2").show()):(b.hideFinderButton(),d.contents().filter(function(){return 3==this.nodeType}).first().replaceWith(b.defaultAddressFieldLabel),a("#shipping_address_2").hasClass("gzd-hidden")&&(a("#shipping_address_2").show(),a("#shipping_address_2").removeClass("gzd-hidden")),a("#shipping_address_1").attr("placeholder",b.defaultAddressFieldPlaceholder),a("#shipping_parcelshop_post_number_field").hide())},initParcelFinder:function(){this.$parcelFinderButtonWrapper.hide(),this.$parcelFinderWrapper.find("#wc-gzd-parcel-finder-background-overlay").hide(),this.$parcelFinderWrapper.on("click","#wc-gzd-parcel-finder-background-overlay",this.closeParcelFinder),this.$parcelFinderWrapper.on("click","#wc-gzd-parcel-finder-close-btn",this.closeParcelFinder),this.$parcelFinderButtonWrapper.on("click",".wc-gzd-parcel-finder-open-button",this.openParcelFinder),a(window).on("message",this.saveParcelFinder)},showFinderButton:function(){b.params.enable_finder&&b.$parcelFinderButtonWrapper.show()},hideFinderButton:function(){b.params.enable_finder&&b.$parcelFinderButtonWrapper.hide()},isValidJSON:function(a){try{JSON.parse(a)}catch(b){return!1}return!0},saveParcelFinder:function(c){if("undefined"!==c.originalEvent.data&&b.isValidJSON(c.originalEvent.data)){var d=JSON.parse(c.originalEvent.data);if("object"==typeof d&&d.countryCode){var e=d.countryCode.toUpperCase();a(".wc-gzd-parcel-finder-shipping-country-error").remove(),-1!==a.inArray(e,b.supportedCountries)?(a("#shipping_country").val(d.countryCode.toUpperCase()).trigger("change"),a("#shipping_address_1").val(d.keyWord+" "+d.primaryKeyZipRegion),a("#shipping_address_2").val(d.street+" "+d.houseNo),a("#shipping_city").val(d.city),a("#shipping_postcode").val(d.zipCode)):(a(".woocommerce-error").length>0?a(".woocommerce-error").append('<li class="wc-gzd-parcel-finder-shipping-country-error">'+b.params.shipping_country_error+"</li>"):a("form.woocommerce-checkout").prepend('<ul class="woocommerce-error wc-gzd-parcel-finder-shipping-country-error"><li>'+b.params.shipping_country_error+"</li></ul>"),a("html, body").animate({scrollTop:a("form.checkout").offset().top-100},1e3)),"de"===d.countryCode&&a("#shipping_address_2").val(""),b.closeParcelFinder()}}},openParcelFinder:function(){return b.$parcelFinderWrapper.find("iframe").attr("src",b.params.iframe_src),b.$parcelFinderWrapper.find("#wc-gzd-parcel-finder-background-overlay").show(),!1},closeParcelFinder:function(){b.$parcelFinderWrapper.find("#wc-gzd-parcel-finder-background-overlay").hide()}};b.init()});